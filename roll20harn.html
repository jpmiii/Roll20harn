<div class="sheet">

<div>
    <button type="action" name="act_character" >Character</button>
    <button type="action" name="act_skills" >Skills</button>
    <button type="action" name="act_combat" >Combat</button>
    <button type="action" name="act_armor" >Armor</button>
    <button type="action" name="act_inventory" >Inventory</button>
    <button type="action" name="act_supernatural" >Supernatural</button>
    <button type="action" name="act_notes" >Notes</button>

</div>

<input type='hidden' class='sheet-tabstoggle' name='attr_sheetTab'  value='character'  />

<div class='sheet-character'>

<div class="sheet-row">
    <div class="sheet-info-col">
        <h4 class="sheet-section-head">Personal</h4>
        <div>
            <div class="sheet-info-label">Name</div>
            <input type="text" name="attr_NAME" class="sheet-info-input">
        </div>
        <div>
            <div class="sheet-info-label">Occupation</div>
            <input type="text" name="attr_OCCUPATION" class="sheet-info-input">
        </div>
        <div>
            <div class="sheet-info-label">Race</div>
            <input type="text" name="attr_SPECIES" class="sheet-info-input">
        </div>
        <div>
            <div class="sheet-info-label">Gender</div>
            <input type="text" name="attr_GENDER" class="sheet-info-input">
        </div>
        <div>
            <div class="sheet-info-label">Birthdate</div>
            <input type="text" name="attr_BIRTHDATE" class="sheet-info-input">
        </div>
        <div>
            <div class="sheet-info-label">Sunsign</div>
            <select name="attr_SUNSIGN" class="sheet-info-input">
                <option value="Ulandus">Ulandus</option>
                <option value="Ulandus-Aralius">Ulandus-Aralius</option>
                <option value="Aralius">Aralius</option>
                <option value="Aralius-Feniri">Aralius-Feniri</option>
                <option value="Feniri">Feniri</option>
                <option value="Feniri-Ahnu">Feniri-Ahnu</option>
                <option value="Ahnu">Ahnu</option>
                <option value="Ahnu-Angberelius">Ahnu-Angberelius</option>
                <option value="Angberelius">Angberelius</option>
                <option value="Angberelius-Nadai">Angberelius-Nadai</option>
                <option value="Nadai">Nadai</option>
                <option value="Nadai-Hirin">Nadai-Hirin</option>
                <option value="Hirin">Hirin</option>
                <option value="Hirin-Tarael">Hirin-Tarael</option>
                <option value="Tarael">Tarael</option>
                <option value="Tarael-Tai">Tarael-Tai</option>
                <option value="Tai">Tai</option>
                <option value="Tai-Skorus">Tai-Skorus</option>
                <option value="Skorus">Skorus</option>
                <option value="Skorus-Masara">Skorus-Masara</option>
                <option value="Masara">Masara</option>
                <option value="Masara-Lado">Masara-Lado</option>
                <option value="Lado">Lado</option>
                <option value="Lado-Ulandus">Lado-Ulandus</option>
            </select>
        </div>
        <div>
            <div class="sheet-info-label">Diety</div>
            <input type="text" name="attr_DIETY" class="sheet-info-input">
        </div>
        <hr class="sheet-hr">
        <div>
            <div class="sheet-stat-label">Age</div>
            <input type="text" name="attr_AGE" class="sheet-stat-value">
            <div class="sheet-stat-label">Morality</div>
            <input type="text" name="attr_MORAL" class="sheet-stat-value">
            <div class="sheet-stat-label">Piety</div>
            <input type="text" name="attr_PIETY" class="sheet-stat-value">
        </div>
        <div>
            <div class="sheet-stat-label">Height</div>
            <input type="text" name="attr_HEIGHT" class="sheet-stat-value">
            <div class="sheet-stat-label">Frame</div>
            <input type="text" name="attr_FRAME" class="sheet-stat-value">
            <div class="sheet-stat-label">Weight</div>
            <input type="text" name="attr_WEIGHT" class="sheet-stat-value">
        </div>
        <div>
            <div class="sheet-stat-label">Skin</div>
            <input type="text" name="attr_COMPLEXION" class="sheet-stat-value">
            <div class="sheet-stat-label">Hair</div>
            <input type="text" name="attr_HAIR_COLORS" class="sheet-stat-value">
            <div class="sheet-stat-label">Eyes</div>
            <input type="text" name="attr_EYE_COLOR" class="sheet-stat-value">
        </div>
    </div>

    <div class="sheet-stat-col">
        <h4 class="sheet-section-head">Attributes</h4>
        <div>
            <div class="sheet-stat-label sheet-font-heavy">STR</div>
            <div class="sheet-stat-value"><input type="text" name="attr_STR" class="sheet-stat-value" value="0"></div>
            <div class="sheet-stat-label">EYE</div>
            <div class="sheet-stat-value"><input type="text" name="attr_EYE" class="sheet-stat-value" value="0"></div>
        </div>
        <div>
            <div class="sheet-stat-label sheet-font-heavy">STA</div>
            <div class="sheet-stat-value"><input type="text" name="attr_STA" class="sheet-stat-value" value="0"></div>
            <div class="sheet-stat-label">HRG</div>
            <div class="sheet-stat-value"><input type="text" name="attr_HRG" class="sheet-stat-value" value="0"></div>
        </div>
        <div>
            <div class="sheet-stat-label sheet-font-heavy">DEX</div>
            <div class="sheet-stat-value"><input type="text" name="attr_DEX" class="sheet-stat-value" value="0"></div>
            <div class="sheet-stat-label">SML</div>
            <div class="sheet-stat-value"><input type="text" name="attr_SML" class="sheet-stat-value" value="0"></div>
        </div>
        <div>
            <div class="sheet-stat-label  sheet-font-heavy">AGL</div>
            <div class="sheet-stat-value"><input type="text" name="attr_AGL" class="sheet-stat-value" value="0"></div>
            <div class="sheet-stat-label">VOI</div>
            <div class="sheet-stat-value"><input type="text" name="attr_VOI" class="sheet-stat-value" value="0"></div>
        </div>
        <div>
            <div class="sheet-stat-label sheet-font-heavy">INT</div>
            <div class="sheet-stat-value"><input type="text" name="attr_INT" class="sheet-stat-value" value="0"></div>
            <div class="sheet-stat-label">CML</div>
            <div class="sheet-stat-value"><input type="text" name="attr_CML" class="sheet-stat-value" value="0"></div>
        </div>
        <div>
            <div class="sheet-stat-label sheet-font-heavy">AUR</div>
            <div class="sheet-stat-value"><input type="text" name="attr_AUR" class="sheet-stat-value" value="0"></div>
        </div>
        <div>
            <div class="sheet-stat-label sheet-font-heavy">WIL</div>
            <div class="sheet-stat-value"><input type="text" name="attr_WIL" class="sheet-stat-value" value="0"></div>
        </div>
    </div>

    <div class="sheet-info-col">
        <h4 class="sheet-section-head">Family</h4>
        <div>
            <div class="sheet-info-label">Birthplace</div>
            <input type="text" name="attr_BIRTHPLACE" class="sheet-profile-input">
        </div>
        <div>
            <div class="sheet-info-label">Culture</div>
            <input type="text" name="attr_CULTURE" class="sheet-profile-input">
        </div>
        <div>
            <div class="sheet-info-label">Social Class</div>
            <input type="text" name="attr_SOCIAL_CLASS" class="sheet-profile-input">
        </div>
        <div>
            <div class="sheet-info-label">Sibling Rank</div>
            <input type="text" name="attr_SIBLING_RANK" class="sheet-profile-input">
        </div>
        <div>
            <div class="sheet-info-label">Parent</div>
            <input type="text" name="attr_PARENT" class="sheet-profile-input">
        </div>
        <div>
            <div class="sheet-info-label">Estrangement</div>
            <input type="text" name="attr_ESTRANGEMENT" class="sheet-profile-input">
        </div>
        <div>
            <div class="sheet-info-label">Clanhead</div>
            <input type="text" name="attr_CLANHEAD" class="sheet-profile-input">
        </div>
        <div>
            <div class="sheet-info-label">Mental</div>
            <input type="text" name="attr_MENTAL" class="sheet-profile-input">
        </div>
        <div>
            <div class="sheet-info-label">Physical</div>
            <input type="text" name="attr_PHYSICAL" class="sheet-profile-input">
        </div>
    </div>
</div>

</div><div class='sheet-skills'>

<hr class="sheet-hr">
<div class="sheet-3colrow sheet-row">


    <div class="sheet-col">
        <h4 class="sheet-section-head">Combat</h4>
        <div>
            <div class="sheet-skill-header sheet-skill-label">Skill</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center">SB</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center">ML</div>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_INITIATIVE_NAME" value="Initiative" disabled="true">
            <input type="text" name="attr_INITIATIVE_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_INITIATIVE_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{INITIATIVE_NAME}}} {{rolltarget=[[@{INITIATIVE_ML} - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{INITIATIVE_ML}}}"
                    name="roll_InitiativeCheck"></button>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_UNARMED_NAME" value="Unarmed" disabled="true">
            <input type="text" name="attr_UNARMED_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_UNARMED_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{UNARMED_NAME}}} {{rolltarget=[[@{UNARMED_ML} - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{UNARMED_ML}}}"
                    name="roll_UnarmedCheck"></button>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_DODGE_NAME" value="Dodge" disabled="true">
            <input type="text" name="attr_DODGE_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_DODGE_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{DODGE_NAME}}} {{rolltarget=[[@{DODGE_ML} - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{DODGE_ML}}}"
                    name="roll_DodgeCheck"></button>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_RIDING_NAME" value="Riding" disabled="true">
            <input type="text" name="attr_RIDING_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_RIDING_ML" class="sheet-skill-value" value="0">
            <input type="hidden" name="attr_STEED_INIT" class="sheet-skill-value" value="0">
            <input type="hidden" name="attr_RIDER" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{RIDING_NAME}}} {{rolltarget=[[[[(@{RIDING_ML} + @{STEED_INIT})/2]] - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{RIDING_ML}}}"
                    name="roll_RidingCheck"></button>
        </div>
        <fieldset class="repeating_combatskill">
            <div>
                <input type="text" name="attr_COMBATSKILL_NAME" class="sheet-skill-label">
                <input type="text" name="attr_COMBATSKILL_SB" class="sheet-skill-value" value="0">
                <input type="text" name="attr_COMBATSKILL_ML" class="sheet-skill-value" value="0">
                <button type="roll"
                        value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{COMBATSKILL_NAME}}} {{rolltarget=[[@{COMBATSKILL_ML} - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{COMBATSKILL_ML}}}"
                        name="roll_CombatSkillCheck"></button>
            </div>
        </fieldset>
    </div>
    <div class="sheet-col">
        <h4 class="sheet-section-head">Physical</h4>
        <div>
            <div class="sheet-skill-header sheet-skill-label">Skill</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center">SB</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center">ML</div>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_CLIMBING_NAME" value="Climbing" disabled="true">
            <input type="text" name="attr_CLIMBING_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_CLIMBING_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{CLIMBING_NAME}}} {{rolltarget=[[@{CLIMBING_ML} - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{CLIMBING_ML}}}"
                    name="roll_ClimbingSkillCheck"></button>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_CONDITION_NAME" value="Condition" disabled="true">
            <input type="text" name="attr_CONDITION_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_CONDITION_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{CONDITION_NAME}}} {{rolltarget=[[@{CONDITION_ML} - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{CONDITION_ML}}}"
                    name="roll_ConditionSkillCheck"></button>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_JUMPING_NAME" value="Jumping" disabled="true">
            <input type="text" name="attr_JUMPING_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_JUMPING_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{JUMPING_NAME}}} {{rolltarget=[[@{JUMPING_ML} - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{JUMPING_ML}}}"
                    name="roll_JumpingSkillCheck"></button>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_STEALTH_NAME" value="Stealth" disabled="true">
            <input type="text" name="attr_STEALTH_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_STEALTH_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{STEALTH_NAME}}} {{rolltarget=[[@{STEALTH_ML} - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{STEALTH_ML}}}"
                    name="roll_StealthSkillCheck"></button>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_THROWING_NAME" value="Throwing" disabled="true">
            <input type="text" name="attr_THROWING_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_THROWING_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{THROWING_NAME}}} {{rolltarget=[[@{THROWING_ML} - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{THROWING_ML}}}"
                    name="roll_ThrowingSkillCheck"></button>
        </div>
        <fieldset class="repeating_physicalskill">
            <div>
                <input type="text" name="attr_PHYSICALSKILL_NAME" class="sheet-skill-label">
                <input type="text" name="attr_PHYSICALSKILL_SB" class="sheet-skill-value" value="0">
                <input type="text" name="attr_PHYSICALSKILL_ML" class="sheet-skill-value" value="0">
                <button type="roll"
                        value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{PHYSICALSKILL_NAME}}} {{rolltarget=[[@{PHYSICALSKILL_ML} - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{PHYSICALSKILL_ML}}}"
                        name="roll_PhysicalSkillCheck"></button>
            </div>
        </fieldset>
    </div>
    <div class="sheet-col">
        <h4 class="sheet-section-head">Communication</h4>
        <div>
            <div class="sheet-skill-header sheet-skill-label">Skill</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center">SB</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center">ML</div>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_AWARENESS_NAME" value="Awareness" disabled="true">
            <input type="text" name="attr_AWARENESS_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_AWARENESS_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{AWARENESS_NAME}}} {{rolltarget=[[@{AWARENESS_ML} - [[(@{UNIVERSAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{UNIVERSAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{AWARENESS_ML}}}"
                    name="roll_AwarenessSkillCheck"></button>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_INTRIGUE_NAME" value="Intrigue" disabled="true">
            <input type="text" name="attr_INTRIGUE_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_INTRIGUE_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{INTRIGUE_NAME}}} {{rolltarget=[[@{INTRIGUE_ML} - [[(@{UNIVERSAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{UNIVERSAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{INTRIGUE_ML}}}"
                    name="roll_IntrigueSkillCheck"></button>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_ORATORY_NAME" value="Oratory" disabled="true">
            <input type="text" name="attr_ORATORY_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_ORATORY_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{ORATORY_NAME}}} {{rolltarget=[[@{ORATORY_ML} - [[(@{UNIVERSAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{UNIVERSAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{ORATORY_ML}}}"
                    name="roll_OratorySkillCheck"></button>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_RHETORIC_NAME" value="Rhetoric" disabled="true">
            <input type="text" name="attr_RHETORIC_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_RHETORIC_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{RHETORIC_NAME}}} {{rolltarget=[[@{RHETORIC_ML} - [[(@{UNIVERSAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{UNIVERSAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{RHETORIC_ML}}}"
                    name="roll_RhetoricSkillCheck"></button>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_SINGING_NAME" value="Singing" disabled="true">
            <input type="text" name="attr_SINGING_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_SINGING_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{SINGING_NAME}}} {{rolltarget=[[@{SINGING_ML} - [[(@{UNIVERSAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{UNIVERSAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{SINGING_ML}}}"
                    name="roll_SingingSkillCheck"></button>
        </div>
        <fieldset class="repeating_communicationskill">
            <div>
                <input type="text" name="attr_COMMUNICATIONSKILL_NAME" class="sheet-skill-label">
                <input type="text" name="attr_COMMUNICATIONSKILL_SB" class="sheet-skill-value" value="0">
                <input type="text" name="attr_COMMUNICATIONSKILL_ML" class="sheet-skill-value" value="0">
                <button type="roll"
                        value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{COMMUNICATIONSKILL_NAME}}} {{rolltarget=[[@{COMMUNICATIONSKILL_ML} - [[(@{UNIVERSAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{UNIVERSAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{COMMUNICATIONSKILL_ML}}}"
                        name="roll_CommunicationSkillCheck"></button>
            </div>
        </fieldset>

    </div>
</div>



<div class="sheet-3colrow">
    <div class="sheet-col">
        <h4 class="sheet-section-head">Craft/Lore</h4>
        <div>
            <div class="sheet-skill-header sheet-skill-label">Skill</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center">SB</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center">ML</div>
        </div>
        <div>
            <input type="text" class="sheet-skill-label" name="attr_PHYSICIAN_NAME" value="Physician" disabled="true">
            <input type="text" name="attr_PHYSICIAN_SB" class="sheet-skill-value" value="0">
            <input type="text" name="attr_PHYSICIAN_ML" class="sheet-skill-value" value="0">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{PHYSICIAN_NAME}}} {{rolltarget=[[@{PHYSICIAN_ML} - [[(@{UNIVERSAL_PENALTY})*5]] + #helper-Physician-roll + ?{Target Modifier?|0}]]}} {{penalty=[[(@{UNIVERSAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{PHYSICIAN_ML}}}"
                    name="roll_AwarenessSkillCheck"></button>
        </div>
        <fieldset class="repeating_loreskill">
            <div>
                <input type="text" name="attr_LORESKILL_NAME" class="sheet-skill-label">
                <input type="text" name="attr_LORESKILL_SB" class="sheet-skill-value" value="0">
                <input type="text" name="attr_LORESKILL_ML" class="sheet-skill-value" value="0">
                <button type="roll"
                        value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{LORESKILL_NAME}}} {{rolltarget=[[@{LORESKILL_ML} - [[(@{UNIVERSAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{UNIVERSAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{LORESKILL_ML}}}"
                        name="roll_LoreSkillCheck"></button>
            </div>
        </fieldset>

    </div>
    <div class="sheet-col">
        <h4 class="sheet-section-head">Ritual</h4>
        <div>
            <div class="sheet-skill-header sheet-skill-label">Skill</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center">SB</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center">ML</div>
        </div>
        <fieldset class="repeating_ritualskill">
            <div>
                <input type="text" name="attr_RITUALSKILL_NAME" class="sheet-skill-label">
                <input type="text" name="attr_RITUALSKILL_SB" class="sheet-skill-value" value="0">
                <input type="text" name="attr_RITUALSKILL_ML" class="sheet-skill-value" value="0">
                <button type="roll"
                        value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{RITUALSKILL_NAME}}} {{rolltarget=[[@{RITUALSKILL_ML} - [[(@{UNIVERSAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{UNIVERSAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{RITUALSKILL_ML}}}"
                        name="roll_RitualSkillCheck"></button>
            </div>
        </fieldset>
    </div>
    <div class="sheet-col">
        <h4 class="sheet-section-head">Magic</h4>
        <div>
            <div class="sheet-skill-header sheet-skill-label">Skill</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center" value="0">SB</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center" value="0">ML</div>
        </div>
        <fieldset class="repeating_magicskill">
            <div>
                <input type="text" name="attr_MAGICSKILL_NAME" class="sheet-skill-label">
                <input type="text" name="attr_MAGICSKILL_SB" class="sheet-skill-value" value="0">
                <input type="text" name="attr_MAGICSKILL_ML" class="sheet-skill-value" value="0">
                <button type="roll" value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls @{MAGICSKILL_NAME}}} {{rolltarget=[[@{MAGICSKILL_ML} - [[(@{UNIVERSAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{UNIVERSAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{MAGICSKILL_ML}}}"
                        name="roll_MagicSkillCheck"></button>
            </div>
        </fieldset>

    </div>
</div>
<hr class="sheet-hr">

        <button type='roll' value='!calcsb @{character_id}' name='roll_calcSB'>Calculate SB</button>


</div><div class='sheet-combat'>

<div class="sheet-row">

    <div class="sheet-col">
        <h4 class="sheet-section-head">Combat Stats</h4>
        <div>
            <div class="sheet-combat-label">Initiative</div>
            <input type="text" name="attr_COMBAT_INITIATIVE" value="0" class="sheet-stat-value" readonly>
        </div>
        <div>
            <div class="sheet-combat-label">Endurance</div>
            <input type="text" name="attr_COMBAT_ENDURANCE" class="sheet-stat-value" value="0" readonly>
        </div>
        <div>
            <div class="sheet-combat-label">Dexterity</div>
            <input type="text" name="attr_COMBAT_DEX" disabled="true" value="@{DEX}" class="sheet-stat-value">
        </div>
        <div>
            <div class="sheet-combat-label">Agility</div>
            <input type="text" name="attr_COMBAT_AGL" disabled="true" value="@{AGL}" class="sheet-stat-value">
        </div>
        <div>
            <div class="sheet-combat-label">Move<br>(ft/sec sprint)</div>
            <input type="text" name="attr_COMBAT_MOVE" disabled="true" class="sheet-stat-value" value="[[round((1.312 * @{STR}) + (1.312 * @{AGL}) + (0.2624 * @{CONDITION_ML}) - 13.12 - @{ENCUMBRANCE} - @{UNIVERSAL_PENALTY})]]">
        </div>
        <div>
            <div class="sheet-combat-label">Dodge</div>
            <input type="text" name="attr_COMBAT_DODGE" disabled="true" class="sheet-skill-value" value="@{DODGE_ML}">
            <button type="roll"
                    value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls Dodge}} {{rolltarget=[[@{COMBAT_DODGE} - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{COMBAT_DODGE}}}"
                    name="roll_CombatDodgeCheck"></button>

        </div>
    </div>
    <div class="sheet-col">
        <h4 class="sheet-section-head">Penalties</h4>
        <div>
            <div class="sheet-combat-label sheet-font-light">Injury Levels</div>
            <input type="text" name="attr_INJURY_TOTAL" value="0" class="sheet-stat-value" readonly>
        </div>
        <div>
            <div class="sheet-combat-label sheet-font-light">Fatigue</div>
            <input type="text" name="attr_FATIGUE_TOTAL" class="sheet-stat-value" value="0">
        </div>
        <div>
            <div class="sheet-combat-label sheet-font-heavy">Universal</div>
            <input type="text" value="0" class="sheet-stat-value" name="attr_UNIVERSAL_PENALTY" readonly>
        </div>
        <div>
            <div class="sheet-combat-label sheet-font-light">Encumb.</div>
            <input type="text" name="attr_ENCUMBRANCE" class="sheet-stat-value" value="0" readonly>
        </div>
        <div>
            <div class="sheet-combat-label sheet-font-heavy">Physical</div>
            <input type="text" name="attr_PHYSICAL_PENALTY" class="sheet-stat-value" value="@{ENCUMBRANCE} + @{UNIVERSAL_PENALTY}" disabled="true">
        </div>
    </div>
    <div class="sheet-col">
        <h4 class="sheet-section-head">Injuries</h4>
        <div>
            <div class="sheet-skill-header sheet-skill-label">Location/Type</div>
            <div class="sheet-skill-header sheet-stat-value sheet-center">SV</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center">LvL</div>
            <div class="sheet-skill-header sheet-skill-value sheet-center">HR</div>
            <div class="sheet-skill-value">&nbsp;</div>
            <div class="sheet-skill-header sheet-check-col sheet-center">Inf</div>
        </div>
        <fieldset class="repeating_injury">
            <div>
                <input type="text" name="attr_INJURY_LOCATION" class="sheet-skill-label">
                <select name="attr_INJURY_SEVERITY" class="sheet-stat-value">
                    <option value="M">M</option>
                    <option value="S">S</option>
                    <option value="G">G</option>
                    <option value="K">K</option>
                </select>
                <input type="text" name="attr_INJURY_LEVEL" class="sheet-skill-value" value="0">
                <input type="text" name="attr_INJURY_HEALINGROLL" class="sheet-skill-value" value="0">
                <div class="sheet-skill-value"><button type="roll" value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=rolls a Healing Check}} {{infected=[[@{INJURY_INFECTED_FEEDBACK}]]}} {{rolltarget=[[(@{INJURY_HEALINGROLL} * [[@{COMBAT_ENDURANCE}]]) + ?{Target Modifier?|0}]]}} {{penalty=[[0]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=[[@{INJURY_HEALINGROLL} * [[@{COMBAT_ENDURANCE}]]]]}} {{note=@{INJURY_LOCATION} @{INJURY_SEVERITY}@{INJURY_LEVEL} H@{INJURY_HEALINGROLL}}}" name="roll_HealingCheck"></button></div>
                <div class="sheet-check-col sheet-center">
                    <input type="checkbox" name="attr_INJURY_INFECTED"><span></span>
                    <input type="hidden" name="attr_INJURY_INFECTED_FEEDBACK" value="0" readonly>
                </div>
            </div>
        </fieldset>
        <hr class="sheet-hr">
        <div class="sheet-row sheet-panel">
            <button type="roll"
                    value="&{template:check-lt} {{character_name=@{NAME}}} {{rolldesc=rolls Shock}} {{rolltarget=[[@{COMBAT_ENDURANCE}]]}} {{rollresult=[[[[@{UNIVERSAL_PENALTY}]]d6]]}} {{base=@{COMBAT_ENDURANCE}}} {{rolltype=[[@{UNIVERSAL_PENALTY}]]d6}} {{penalty=[[0]]}}"
                    name="roll_ShockCheck">Shock
            </button>
            <button type="roll"
                    value="&{template:check-lt} {{character_name=@{NAME}}} {{rolldesc=rolls Stumble}} {{rolltarget=[[@{COMBAT_AGL}]]}} {{rollresult=[[[[3d6]] + @{PHYSICAL_PENALTY}]]}} {{base=@{COMBAT_AGL}}} {{rolltype=3d6+[[@{PHYSICAL_PENALTY}]]}} {{penalty=[[0]]}}"
                    name="roll_StumbleCheck">Stumble
            </button>
            <button type="roll"
                    value="&{template:check-lt} {{character_name=@{NAME}}} {{rolldesc=rolls Fumble}} {{rolltarget=[[@{COMBAT_DEX}]]}} {{rollresult=[[[[3d6]] + @{PHYSICAL_PENALTY}]]}} {{base=@{COMBAT_DEX}}} {{rolltype=3d6+[[@{PHYSICAL_PENALTY}]]}} {{penalty=[[0]]}}"
                    name="roll_FumbleCheck">Fumble
            </button>
        </div>
    </div>
    <div class="sheet-col">
        <h4 class="sheet-section-head">Load Carried</h4>
        <div>
            <input type="text" name="attr_LOAD_WEAPONS" class="sheet-skill-label" value="Weapons" readonly>
            <input type="text" name="attr_LOAD_WEAPONS_TOTAL" class="sheet-stat-value" value="0" readonly>
        </div>
        <div>
            <input type="text" name="attr_LOAD_ARMOR" class="sheet-skill-label" value="Armor" readonly>
            <input type="text" name="attr_LOAD_ARMOR_TOTAL" class="sheet-stat-value" value="0" class="sheet-number-value" readonly>
        </div>
        <div>
            <input type="text" name="attr_LOAD_INVENTORY" class="sheet-skill-label" value="Inventory" readonly>
            <input type="text" name="attr_LOAD_INVENTORY_TOTAL" class="sheet-stat-value" value="0" class="sheet-number-value" readonly>
        </div>
        <div>
            <div class="sheet-skill-label sheet-skill-header sheet-right">Total Weight:</div>
            <input type="text" name="attr_LOAD_TOTAL" class="sheet-stat-value" value="0" readonly>
        </div>
        <div>
            <div class="sheet-skill-label sheet-right">Mounted? </div>
            <div class="sheet-stat-value sheet-center"><input type="checkbox" name="attr_IS_MOUNTED"><span></span>
        </div>
    </div>
</div>

<div class="sheet-row">
    <h4 class="sheet-section-head">Weapons</h4>
    <div>
        <div class="sheet-skill-header sheet-skill-label">Weapon</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">WQ</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">&nbsp;</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">ATK</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">DEF</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">Mod</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">B</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">E</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">P</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">ML</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">AML</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">DML</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">api</div>

        <div class="sheet-skill-header sheet-skill-value sheet-center">atk</div>

        <div class="sheet-skill-header sheet-skill-value sheet-center">def</div>

        <div class="sheet-skill-header sheet-skill-label">Note</div>
    </div>
    <fieldset class="repeating_weapon">
        <div>
            <input type="text" name="attr_WEAPON_NAME" class="sheet-skill-label">
            <input type="text" name="attr_WEAPON_WQ" class="sheet-skill-value" value="0">
            <div class="sheet-skill-value"><button type="roll"  value="&{template:check-lt} {{character_name=@{NAME}}} {{rolldesc=rolls Weapon Break: @{WEAPON_NAME}}} {{rolltarget=[[@{WEAPON_WQ}]]}} {{rollresult=[[3d6]]}} {{base=@{WEAPON_WQ}}} {{rolltype=3d6}} {{penalty=[[0]]}}" name="roll_WeaponBreakCheck"></button></div>
            <input type="text" name="attr_WEAPON_ATK" class="sheet-skill-value" value="0">
            <input type="text" name="attr_WEAPON_DEF" class="sheet-skill-value" value="0">
            <input type="text" name="attr_WEAPON_HM" class="sheet-skill-value" value="0">
            <input type="text" name="attr_WEAPON_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_WEAPON_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_WEAPON_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_WEAPON_ML" class="sheet-skill-value" value="0">
            <input type="text" name="attr_WEAPON_AML" class="sheet-skill-value" disabled="true" value="@{WEAPON_ML} + @{WEAPON_ATK} + @{WEAPON_HM}">
            <input type="text" name="attr_WEAPON_DML" class="sheet-skill-value" disabled="true" value="@{WEAPON_ML} + @{WEAPON_DEF} + @{WEAPON_HM}">
            <div class="sheet-skill-value"><button type="roll"
                                                   value="!sheetattack @{character_id} ?{aim zone|mid|low|high} H ?{Type|melee|missile} ?{Mod|0} @{target|token_id} @{WEAPON_NAME}" name="roll_WeaponAMLSkillCheck"></button></div>
			<div class="sheet-skill-value"><button type="roll"
                                                   value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=attacks with a @{WEAPON_NAME}}} {{rolltarget=[[{[[{[[@{WEAPON_AML} - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]],5}kh1]],95}kl1]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{WEAPON_AML}}} {{note=B(@{WEAPON_B}) E(@{WEAPON_E}) P(@{WEAPON_P})}}" name="roll_WeaponAMLSkillCheck"></button></div>
            <div class="sheet-skill-value"><button type="roll" value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=blocks with a @{WEAPON_NAME}}} {{rolltarget=[[@{WEAPON_DML} - [[(@{PHYSICAL_PENALTY})*5]] + ?{Target Modifier?|0}]]}} {{penalty=[[(@{PHYSICAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{WEAPON_DML}}} {{note=WQ @{WEAPON_WQ}}}" name="roll_WeaponDMLSkillCheck"></button></div>

            <input type="text" name="attr_WEAPON_NOTE" class="sheet-skill-label">
        </div>
    </fieldset>
</div>

</div>

</div><div class='sheet-armor'>

<div class="sheet-row">
    <h4 class="sheet-section-head">Armor Protection</h4>
    <div class="sheet-col">

        <div>
            <div class="sheet-info-label sheet-skill-header">Location</div>
            <div class="sheet-skill-label sheet-skill-header">Compound Layers</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">AQ</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">B</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">E</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">P</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">F</div>
        </div>
        <div>
            <div class="sheet-info-label">Skull</div>
            <input type="text" name="attr_SKULL_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_SKULL_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_SKULL_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_SKULL_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_SKULL_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_SKULL_F" class="sheet-skill-value" value="0">
        </div>
        <div>
            <div class="sheet-info-label">Face</div>
            <input type="text" name="attr_FACE_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_FACE_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_FACE_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_FACE_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_FACE_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_FACE_F" class="sheet-skill-value" value="0">
        </div>
        <div>
            <div class="sheet-info-label">Neck</div>
            <input type="text" name="attr_NECK_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_NECK_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_NECK_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_NECK_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_NECK_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_NECK_F" class="sheet-skill-value" value="0">
        </div>
        <hr class="sheet-hr">
        <div>
            <div class="sheet-info-label">Shoulder</div>
            <input type="text" name="attr_SHOULDER_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_SHOULDER_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_SHOULDER_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_SHOULDER_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_SHOULDER_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_SHOULDER_F" class="sheet-skill-value" value="0">
        </div>
        <div>
            <div class="sheet-info-label">Upper Arm</div>
            <input type="text" name="attr_UPPERARM_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_UPPERARM_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_UPPERARM_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_UPPERARM_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_UPPERARM_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_UPPERARM_F" class="sheet-skill-value" value="0">
        </div>
        <div>
            <div class="sheet-info-label">Elbow</div>
            <input type="text" name="attr_ELBOW_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_ELBOW_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_ELBOW_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_ELBOW_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_ELBOW_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_ELBOW_F" class="sheet-skill-value" value="0">
        </div>
        <div>
            <div class="sheet-info-label">Forearm</div>
            <input type="text" name="attr_FOREARM_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_FOREARM_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_FOREARM_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_FOREARM_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_FOREARM_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_FOREARM_F" class="sheet-skill-value" value="0">
        </div>
        <div>
            <div class="sheet-info-label">Hand</div>
            <input type="text" name="attr_HAND_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_HAND_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_HAND_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_HAND_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_HAND_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_HAND_F" class="sheet-skill-value" value="0">
        </div>
        <div class="sheet-skill-header sheet-skill-label">Calculate Armor Values</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center"><button type='roll' value='!ca @{character_id}' name='roll_calcArmor'></button></div>

    </div>
    <div class="sheet-col">
        <div>
            <div class="sheet-info-label sheet-skill-header">Location</div>
            <div class="sheet-skill-label sheet-skill-header">Compound Layers</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">AQ</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">B</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">E</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">P</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">F</div>
        </div>
        <div>
            <div class="sheet-info-label">Thorax</div>
            <input type="text" name="attr_THORAX_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_THORAX_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_THORAX_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_THORAX_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_THORAX_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_THORAX_F" class="sheet-skill-value" value="0">
        </div>
        <div>
            <div class="sheet-info-label">Abdomen</div>
            <input type="text" name="attr_ABDOMEN_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_ABDOMEN_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_ABDOMEN_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_ABDOMEN_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_ABDOMEN_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_ABDOMEN_F" class="sheet-skill-value" value="0">
        </div>
        <div>
            <div class="sheet-info-label">Hip</div>
            <input type="text" name="attr_HIP_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_HIP_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_HIP_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_HIP_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_HIP_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_HIP_F" class="sheet-skill-value" value="0">
        </div>
        <div>
            <div class="sheet-info-label">Groin</div>
            <input type="text" name="attr_GROIN_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_GROIN_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_GROIN_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_GROIN_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_GROIN_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_GROIN_F" class="sheet-skill-value" value="0">
        </div>
        <hr class="sheet-hr">
        <div>
            <div class="sheet-info-label">Thigh</div>
            <input type="text" name="attr_THIGH_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_THIGH_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_THIGH_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_THIGH_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_THIGH_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_THIGH_F" class="sheet-skill-value" value="0">
        </div>
        <div>
            <div class="sheet-info-label">Knee</div>
            <input type="text" name="attr_KNEE_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_KNEE_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_KNEE_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_KNEE_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_KNEE_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_KNEE_F" class="sheet-skill-value" value="0">
        </div>
        <div>
            <div class="sheet-info-label">Calf</div>
            <input type="text" name="attr_CALF_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_CALF_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_CALF_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_CALF_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_CALF_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_CALF_F" class="sheet-skill-value" value="0">
        </div>
        <div>
            <div class="sheet-info-label">Foot</div>
            <input type="text" name="attr_FOOT_LAYERS" class="sheet-skill-label">
            <input type="text" name="attr_FOOT_AQ" class="sheet-skill-value" value="0">
            <input type="text" name="attr_FOOT_B" class="sheet-skill-value" value="0">
            <input type="text" name="attr_FOOT_E" class="sheet-skill-value" value="0">
            <input type="text" name="attr_FOOT_P" class="sheet-skill-value" value="0">
            <input type="text" name="attr_FOOT_F" class="sheet-skill-value" value="0">
        </div>
    </div>
</div>

</div><div class='sheet-inventory'>

<div class="sheet-row">
    <div class="sheet-row">
        <h4 class="sheet-section-head">Inventory</h4>
        <div class="sheet-skill-header sheet-skill-label">Item</div>
        <div class="sheet-skill-header sheet-skill-label">Type</div>
        <div class="sheet-skill-header sheet-skill-toparea">Notes</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">Price</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">#</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">Q</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">WGT</div>
        <div class="sheet-skill-header sheet-skill-value sheet-center">Worn</div>
        <fieldset class="repeating_inventoryitems">
            <span style="vertical-align: top;">
                <input type="text" name="attr_INVENTORY_NAME" class="sheet-skill-label">
                <input type="text" name="attr_INVENTORY_TYPE" class="sheet-skill-label">
            </span>
            <textarea name="attr_INVENTORY_NOTES" class="sheet-skill-area" height=18></textarea>
            <span style="vertical-align: top;">
                <input type="text" name="attr_INVENTORY_PRICE" class="sheet-skill-value" value="0">
                <input type="text" name="attr_INVENTORY_QUANTITY" class="sheet-skill-value" value="1">
                <input type="text" name="attr_INVENTORY_Q" class="sheet-skill-value" value="0">
                <input type="text" name="attr_INVENTORY_WGT" class="sheet-skill-value" value="0">
                <input type="checkbox" name="attr_INVENTORY_WORN">
            </span>
        </fieldset>
    </div>
    <div class="sheet-row"><button type='roll' value='!addItem @{character_id} #helper-ItemList'>Add Item</button>
    <button type='roll' value='!addItem @{character_id} #helper-ArmorList'>Add Armor</button>
    <button type='roll' value='!addItem @{character_id} #helper-WeaponList'>Add Weapon</button>

    </div>
</div>

</div><div class='sheet-supernatural'>

<div class="sheet-row">

    <div class="sheet-row">
        <h4 class="sheet-section-head">Spells</h4>
        <div>
            <div class="sheet-skill-label sheet-skill-header">Name</div>
            <div class="sheet-skill-label sheet-skill-header">Convocation</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">Level</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">EML</div>
            <div class="sheet-skill-value sheet-skill-header">&nbsp;</div>
            <div class="sheet-skill-label sheet-skill-header">Notes</div>
        </div>
        <fieldset class="repeating_spells">
            <div>
                <span style="vertical-align: top;">
                    <input type="text" name="attr_SPELL_NAME" class="sheet-skill-label">
                    <input type="text" name="attr_SPELL_CONVOCATION" class="sheet-skill-label">
                    <input type="text" name="attr_SPELL_LEVEL" class="sheet-skill-value" value="0">
                    <input type="hidden" name="attr_SPELL_ML" class="sheet-skill-value" value="0">
                    <input type="text" name="attr_SPELL_EML" class="sheet-skill-value" value="0">
                    <div class="sheet-skill-value"><button type="roll" value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=casts @{SPELL_NAME}(@{SPELL_CONVOCATION})}} {{rolltarget=[[{[[{[[@{SPELL_EML} - [[(@{SPELL_LEVEL})*5]] - [[(@{UNIVERSAL_PENALTY})*5]] + ?{Target Modifier?|0}]],5}kh1]],95}kl1]]}} {{penalty=[[(@{UNIVERSAL_PENALTY})*5]] - [[(@{SPELL_LEVEL})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{SPELL_EML}}} {{note=@{SPELL_NOTE}}}" name="roll_SpellCastCheck"></button></div>
                </span>
                <textarea name="attr_SPELL_NOTE" class="sheet-skill-area"></textarea>
            </div>
        </fieldset>

    </div>
    <div class="sheet-row">
        <h4 class="sheet-section-head">Rituals</h4>
        <div>
            <div class="sheet-skill-label sheet-skill-header">Name</div>
            <div class="sheet-skill-label sheet-skill-header">Diety</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">Level</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">EML</div>
            <div class="sheet-skill-value sheet-skill-header">&nbsp;</div>
            <div class="sheet-skill-label sheet-skill-header">Notes</div>
        </div>
        <fieldset class="repeating_rituals">
            <div>
                <span style="vertical-align: top;">
                    <input type="text" name="attr_RITUAL_NAME" class="sheet-skill-label">
                    <input type="text" name="attr_RITUAL_RELIGION" class="sheet-skill-label">
                    <input type="text" name="attr_RITUAL_LEVEL" class="sheet-skill-value" value="0">
                    <input type="text" name="attr_RITUAL_EML" class="sheet-skill-value" value="0">
                    <input type="hidden" name="attr_RITUAL_ML" class="sheet-skill-value" value="0">
                    <div class="sheet-skill-value"><button type="roll" value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=performs @{RITUAL_NAME}(@{RITUAL_RELIGION})}} {{rolltarget=[[{[[{[[@{RITUAL_EML} - [[(@{RITUAL_LEVEL})*5]]- [[(@{UNIVERSAL_PENALTY})*5]] + ?{Target Modifier?|0}]],5}kh1]],95}kl1]]}} {{penalty=[[(@{UNIVERSAL_PENALTY})*5]] - [[(@{RITUAL_LEVEL})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{RITUAL_EML}}} {{note=@{RITUAL_NOTE}}}" name="roll_RitualCheck"></button></div>
                </span>
                <textarea name="attr_RITUAL_NOTE" class="sheet-skill-area"></textarea>
            </div>
        </fieldset>
    </div>
    <div class="sheet-row">
        <h4 class="sheet-section-head">Psionic Talents</h4>
        <div>
            <div class="sheet-skill-label sheet-skill-header">Talent</div>
            <div class="sheet-stat-value sheet-skill-header">Fatigue</div>
            <div class="sheet-stat-value sheet-skill-header sheet-center">Time</div>
            <div class="sheet-skill-value sheet-skill-header sheet-center">EML</div>
            <div class="sheet-skill-value sheet-skill-header">&nbsp;</div>
            <div class="sheet-skill-label sheet-skill-header">Notes</div>
        </div>
        <fieldset class="repeating_psionics">
            <div>
                <span style="vertical-align: top;">
                    <input type="text" name="attr_TALENT_NAME" class="sheet-skill-label">
                    <input type="text" name="attr_TALENT_FATIGUE" class="sheet-stat-value" value="0">
                    <input type="text" name="attr_TALENT_TIME" class="sheet-stat-value" value="">
                    <input type="text" name="attr_TALENT_EML" class="sheet-skill-value" value="0">
                    <div class="sheet-skill-value"><button type="roll" value="&{template:rollcheck} {{character_name=@{NAME}}} {{rolldesc=invokes @{TALENT_NAME}}} {{rolltarget=[[{[[{[[@{TALENT_EML} - [[(@{UNIVERSAL_PENALTY})*5]] + ?{Target Modifier?|0}]],5}kh1]],95}kl1]]}} {{penalty=[[(@{UNIVERSAL_PENALTY})*5]]}} {{rollresult=[[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]]}} {{targetmod=[[?{Target Modifier?|0}]]}} {{ml=@{TALENT_EML}}} {{note=(@{TALENT_TIME}); @{TALENT_NOTE}}}" name="roll_TalentCheck"></button></div>
                </span>
                <textarea name="attr_TALENT_NOTE" class="sheet-skill-area"></textarea>
            </div>
        </fieldset>
    </div>
</div>

</div><div class='sheet-notes'>


<textarea name="attr_TEXTAREA_NOTE"></textarea>
<br/>Log<br/>
<textarea name="attr_TEXTAREA_LOG"></textarea>
<br/>Sheet<br/>
<textarea name="attr_TEXTAREA_SHEET"></textarea>
<br/>skill_roll_list<br/>
<textarea name="attr_skill_roll_list"></textarea>
    <br> Option Rule: Endurance = Condition / 5 <input type="checkbox" name="attr_OPTIONAL_RULE_1" checked>
</div>
</div>


</div>
<!-- ROLL TEMPLATES/-->

<!--
props:
* character_name: Name of chaaracter performing action.
* rolldesc: Text describing roll in header.
* penalty:  Autocalculated in value from Universal or Physical Penalty. Applied in rolltarget
* targetmod:  Dieroll query in each roll, defaults to 0.  Applied in rolltarget.
* ml:  Unmodified target of the roll.
* rolltarget:  Actual target of roll, derived from 'ml + (penalty * 5) + targetmod'
* rollresult: Die roll result.
* note: Optional property for any additional text at the end of table.
* infection:  sepcial row just for infected wounds, value either 0 or on or not present.

/-->





<rolltemplate class="sheet-rolltemplate-harnroll">
    <table>
        {{#rolldesc}}<tr><th><span class="sheet-tcat">{{rolldesc}}</span></th></tr>{{/rolldesc}}
		{{#header}}<tr><th><span class="sheet-tcat">{{header}}</span></th></tr>{{/header}}
        {{#rollresult}}<tr><td>Attacker<br>{{#rolltarget}}{{rolltarget}}{{/rolltarget}}{{rollresult}} </td></tr>{{/rollresult}}
        {{#info}}
        <tr>
            <td class="sheet-note">{{info}}</td>
        </tr>
        {{/info}}
        {{#def}}
        <tr>
            <td class="sheet-note">{{def}}</td>
        </tr>
        {{/def}}

        {{#rollsuccess}}
            {{#rollTotal() rollsuccess 3}}
            <tr>
                <td class="sheet-crit-success">Critical Success!!</td>
            </tr>
            {{/rollTotal() rollsuccess 3}}
            {{#rollTotal() rollsuccess 2}}
            <tr>
                <td class="sheet-success">Marginal Success.</td>
            </tr>
            {{/rollTotal() rollsuccess 2}}



            {{#rollTotal() rollsuccess 0}}
            <tr>
                <td class="sheet-crit-failure">Critical Failure!!</td>
            </tr>
            {{/rollTotal() rollsuccess 0}}
            {{#rollTotal() rollsuccess 1}}
            <tr>
                <td class="sheet-failure">Marginal Failure.</td>
            </tr>
            {{/rollTotal() rollsuccess 1}}

        {{/rollsuccess}}
        {{#drollresult}}<tr><td>Defender<br>{{#drolltarget}}{{drolltarget}}{{/drolltarget}}{{drollresult}}</td></tr>{{/drollresult}}


        {{#drollsuccess}}
            {{#rollTotal() drollsuccess 3}}
            <tr>
                <td class="sheet-crit-success">Critical Success!!</td>
            </tr>
            {{/rollTotal() drollsuccess 3}}
            {{#rollTotal() drollsuccess 2}}
            <tr>
                <td class="sheet-success">Marginal Success.</td>
            </tr>
            {{/rollTotal() drollsuccess 2}}



            {{#rollTotal() drollsuccess 0}}
            <tr>
                <td class="sheet-crit-failure">Critical Failure!!</td>
            </tr>
            {{/rollTotal() drollsuccess 0}}
            {{#rollTotal() drollsuccess 1}}
            <tr>
                <td class="sheet-failure">Marginal Failure.</td>
            </tr>
            {{/rollTotal() drollsuccess 1}}

        {{/drollsuccess}}
        {{#result}}
        <tr><th><span class="tcat">Result: </span>{{result}}</th></tr>
        <tr>
            <td class="sheet-note">{{#aresult}}{{aresult}}<br>{{/aresult}}{{#dresult}}{{dresult}}{{/dresult}}</td>
        </tr>
        {{/result}}
        {{#note}}
        <tr>
            <td class="sheet-note">{{note}}</td>
        </tr>
        {{/note}}
    </table>
</rolltemplate>



<rolltemplate class="sheet-rolltemplate-harn-defend">
    <table>

        {{#rollresult}}<tr><td>{{#rolltarget}}{{rolltarget}}{{/rolltarget}}{{rollresult}}</td></tr>{{/rollresult}}
        {{#info}}
        <tr>
            <td class="sheet-note">{{info}}</td>
        </tr>
        {{/info}}
        {{#def}}
        <tr>
            <td class="sheet-note">{{def}}</td>
        </tr>
        {{/def}}

        {{#rollsuccess}}
            {{#rollTotal() rollsuccess 3}}
            <tr>
                <td class="sheet-crit-success">Critical<br><br>Success!!</td>
            </tr>
            {{/rollTotal() rollsuccess 3}}
            {{#rollTotal() rollsuccess 2}}
            <tr>
                <td class="sheet-success">Marginal Success.</td>
            </tr>
            {{/rollTotal() rollsuccess 2}}



            {{#rollTotal() rollsuccess 0}}
            <tr>
                <td class="sheet-crit-failure">Critical<br><br>Failure!!</td>
            </tr>
            {{/rollTotal() rollsuccess 0}}
            {{#rollTotal() rollsuccess 1}}
            <tr>
                <td class="sheet-failure">Marginal Failure.</td>
            </tr>
            {{/rollTotal() rollsuccess 1}}

        {{/rollsuccess}}
        {{#aresult}}<tr><td>{{aresult}}</td></tr>{{/aresult}}
        {{#rolldesc}}<tr><th><img src="https://jpmiii.github.io/Roll20harn/harnfancy/break.png"><br><span class="sheet-tcat">{{rolldesc}}</span><br><img src="https://jpmiii.github.io/Roll20harn/harnfancy/break.png"></th></tr>{{/rolldesc}}
        {{#drollresult}}<tr><td>{{#drolltarget}}{{drolltarget}}{{/drolltarget}}{{drollresult}}</td></tr>{{/drollresult}}


        {{#drollsuccess}}
            {{#rollTotal() drollsuccess 3}}
            <tr>
                <td class="sheet-crit-success">Critical<br><br>Success!!</td>
            </tr>
            {{/rollTotal() drollsuccess 3}}
            {{#rollTotal() drollsuccess 2}}
            <tr>
                <td class="sheet-success">Marginal Success.</td>
            </tr>
            {{/rollTotal() drollsuccess 2}}



            {{#rollTotal() drollsuccess 0}}
            <tr>
                <td class="sheet-crit-failure">Critical<br><br>Failure!!</td>
            </tr>
            {{/rollTotal() drollsuccess 0}}
            {{#rollTotal() drollsuccess 1}}
            <tr>
                <td class="sheet-failure">Marginal Failure.</td>
            </tr>
            {{/rollTotal() drollsuccess 1}}

        {{/drollsuccess}}
        {{#dresult}}<tr><td>{{dresult}}</td></tr>{{/dresult}}
        {{#result}}
        <tr><th class="sheet-note-bottom"><span class="tcat">Result</span><br>{{result}}<br><br></th></tr>
        {{/result}}
        {{#note}}
        <tr>
            <td class="sheet-note">{{note}}</td>
        </tr>
        {{/note}}

    </table>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-rollcheck">
    <table>
        <tr>
            <th><span class="tcat">{{character_name}} {{rolldesc}}</span></th>
        </tr>
        {{#infected}}
            {{#rollTotal() infected 1}}
                <tr>
                    <td class="sheet-infected">Infected</td>
                </tr>
            {{/rollTotal() infected 1}}
        {{/infected}}
        <tr>
            <td><span class="sheet-tcat">Target Mods:</span>
                ML({{ml}}),
                {{#penalty}}Penalty(-{{penalty}}), {{/penalty}}
                {{#targetmod}}Mod({{targetmod}}){{/targetmod}}
            </td>
        </tr>
        {{#rolltarget}}<tr><td><span class="sheet-tcat">Target:</span> {{rolltarget}}</td></tr>{{/rolltarget}}
        <tr><td><span class="sheet-tcat">Roll(1d100):</span> {{rollresult}} </td></tr>


        {{^rollsuccess}}


            {{#^rollGreater() rollresult rolltarget}}
            {{#rollWasCrit() rollresult }}
            <tr>
                <td class="sheet-crit-success">Critical<br>Success!!</td>
            </tr>
            {{/rollWasCrit() rollresult }}
            {{#^rollWasCrit() rollresult }}
            <tr>
                <td class="sheet-success">Marginal Success.</td>
            </tr>
            {{/^rollWasCrit() rollresult }}
            {{/^rollGreater() rollresult rolltarget}}

            {{#rollGreater() rollresult rolltarget}}
            {{#rollWasCrit() rollresult }}
            <tr>
                <td class="sheet-crit-failure">Critical<br>Failure!!</td>
            </tr>
            {{/rollWasCrit() rollresult }}
            {{#^rollWasCrit() rollresult }}
            <tr>
                <td class="sheet-failure">Marginal Failure.</td>
            </tr>
            {{/^rollWasCrit() rollresult }}
            {{/rollGreater() rollresult rolltarget}}

        {{/rollsuccess}}



        {{#rollsuccess}}
            {{#rollTotal() rollsuccess 3}}
            <tr>
                <td class="sheet-crit-success">Critical Success!!</td>
            </tr>
            {{/rollTotal() rollsuccess 3}}
            {{#rollTotal() rollsuccess 2}}
            <tr>
                <td class="sheet-success">Marginal Success.</td>
            </tr>
            {{/rollTotal() rollsuccess 2}}



            {{#rollTotal() rollsuccess 0}}
            <tr>
                <td class="sheet-crit-failure">Critical Failure!!</td>
            </tr>
            {{/rollTotal() rollsuccess 0}}
            {{#rollTotal() rollsuccess 1}}
            <tr>
                <td class="sheet-failure">Marginal Failure.</td>
            </tr>
            {{/rollTotal() rollsuccess 1}}

        {{/rollsuccess}}


        {{#note}}
        <tr>
            <td class="sheet-note">{{note}}</td>
        </tr>
        {{/note}}

    </table>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-check-lt">
    <table>
        <tr>
            <th><span class="tcat">{{character_name}} {{rolldesc}}</span></th>
        </tr>


        {{#rollGreater() penalty 0}}
        <tr>
            <td><span class="tcat">Target: </span>({{base}}-{{penalty}}) = {{rolltarget}}</td>
        </tr>
        {{/rollGreater() penalty 0}}
        {{#^rollGreater() penalty 0}}
        <tr>
            <td><span class="tcat">Target: </span>{{rolltarget}}</td>
        </tr>
        {{/^rollGreater() penalty 0}}
        <tr>
            <td><span class="tcat">Roll({{rolltype}}): </span> {{rollresult}}</td>
        </tr>
        {{#^rollGreater() rollresult rolltarget}}
        <tr>
            <td class="sheet-success">Success.</td>
        </tr>
        {{/^rollGreater() rollresult rolltarget}}
        {{#rollGreater() rollresult rolltarget}}
        <tr>
            <td class="sheet-failure">Failure.</td>
        </tr>
        {{/rollGreater() rollresult rolltarget}}
    </table>
</rolltemplate>




<rolltemplate class="sheet-rolltemplate-harn-fancy">
    <div class="sheet-harn-fancy-bg">
       <div class="sheet-harn-fancy-top">
            <div class="sheet-harn-fancy-header">
				{{#rolldesc}}{{rolldesc}}{{/rolldesc}}
                {{#header}}{{header}}{{/header}}
            </div>
            <img src="https://jpmiii.github.io/Roll20harn/harnfancy/break.png"><br>
            <div class="sheet-harn-fancy-content">
                {{#info}}{{info}}<br><img src="https://jpmiii.github.io/Roll20harn/harnfancy/break.png">{{/info}}
            </div>
            <div class="sheet-harn-fancy-content">
                {{#def}}{{def}}<br><img src="https://jpmiii.github.io/Roll20harn/harnfancy/break.png">{{/def}}
            </div>
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-harn-bottom">
    <div class="sheet-harn-bottom-bg">
       <div class="sheet-harn-bottom-top">
            <div class="sheet-harn-bottom-header">
                {{#header}}{{header}}{{/header}}
            </div>
            <img src="https://jpmiii.github.io/Roll20harn/harnfancy/break.png"><br>
            <div class="sheet-harn-bottom-content">
                {{#info}}{{info}}<br><img src="https://jpmiii.github.io/Roll20harn/harnfancy/break.png">{{/info}}
            </div>
            <div class="sheet-harn-bottom-content">
                {{#def}}{{def}}<br><img src="https://jpmiii.github.io/Roll20harn/harnfancy/break.png">{{/def}}
            </div>
        </div>
    </div>
</rolltemplate>

<!-- INJURY TOTALS /-->
<script type="text/worker">

on("change:repeating_injury:injury_level remove:repeating_injury sheet:opened", function() {
	getSectionIDs("repeating_injury", function(IDArray) {
		var fieldNames = [];
        for (var i=0; i < IDArray.length; i++) {
			fieldNames.push("repeating_injury_" + IDArray[i] + "_INJURY_LEVEL");
		}

        var total = 0;
        getAttrs(fieldNames, function(values) {
			for (var i=0; i < IDArray.length; i++) {
				total += parseInt(values["repeating_injury_" + IDArray[i] + "_INJURY_LEVEL"])||0;
			}
			setAttrs({
				"INJURY_TOTAL": total
			});
        });
	});
});

</script>


<!-- SPELLS EML /-->
<script type="text/worker">
    on("change:repeating_magicskill:magicskill_ml sheet:opened", function() {

        getSectionIDs("repeating_magicskill", function(IDArray) {
            var str1 = "";
            var spellskills = {};
            var f = [];
            for (var i=0; i < IDArray.length; i++) {
                f.push("repeating_magicskill_" + IDArray[i] + "_MAGICSKILL_NAME");
                f.push("repeating_magicskill_" + IDArray[i] + "_MAGICSKILL_ML");
            }
            getAttrs(f, function(values) {
            	for (var i=0; i < IDArray.length; i++) {
                    spellskills[values["repeating_magicskill_" + IDArray[i] + "_MAGICSKILL_NAME"]] =
                        parseInt(values["repeating_magicskill_" + IDArray[i] + "_MAGICSKILL_ML"])||0;
                    str1 += values["repeating_magicskill_" + IDArray[i] + "_MAGICSKILL_NAME"] +": "+spellskills[values["repeating_magicskill_" + IDArray[i] + "_MAGICSKILL_NAME"]]+"\n";

            	}
            	var f2 = [];
            	getSectionIDs("repeating_spells", function(IDArray2) {
                    for (var i=0; i < IDArray2.length; i++) {
                        f2.push("repeating_spells_" + IDArray2[i] + "_SPELL_CONVOCATION");
                        f2.push("repeating_spells_" + IDArray2[i] + "_SPELL_ML");
                        f2.push("repeating_spells_" + IDArray2[i] + "_SPELL_EML");
                    }
                    getAttrs(f2, function(v) {
                    	for (var i=0; i < IDArray2.length; i++) {
                    	    var ml =  parseInt(spellskills[v["repeating_spells_" + IDArray2[i] + "_SPELL_CONVOCATION"]])||0;
                    	    var eml = (parseInt(v["repeating_spells_" + IDArray2[i] + "_SPELL_EML"]) -
                    	        parseInt(v["repeating_spells_" + IDArray2[i] + "_SPELL_ML"]) +
                    	        parseInt(spellskills[v["repeating_spells_" + IDArray2[i] + "_SPELL_CONVOCATION"]]))||0;
                            setAttrs({
                                ["repeating_spells_" + IDArray2[i] + "_SPELL_ML"]: ml,
                                ["repeating_spells_" + IDArray2[i] + "_SPELL_EML"]: eml

                            });
                    	}
                    });
            	});
            });
        });
    });

</script>


<!-- RITUAL EML /-->
<script type="text/worker">
    on("change:repeating_ritualskill:ritualskill_ml sheet:opened", function() {

        getSectionIDs("repeating_ritualskill", function(IDArray) {
            var ritualskills = {};
            var f = [];
            for (var i=0; i < IDArray.length; i++) {
                f.push("repeating_ritualskill_" + IDArray[i] + "_RITUALSKILL_NAME");
                f.push("repeating_ritualskill_" + IDArray[i] + "_RITUALSKILL_ML");
            }
            getAttrs(f, function(values) {
            	for (var i=0; i < IDArray.length; i++) {
                    ritualskills[values["repeating_ritualskill_" + IDArray[i] + "_RITUALSKILL_NAME"]] =
                        parseInt(values["repeating_ritualskill_" + IDArray[i] + "_RITUALSKILL_ML"])||0;
            	}
            	var f2 = [];
            	getSectionIDs("repeating_rituals", function(IDArray2) {
                    for (var i=0; i < IDArray2.length; i++) {
                        f2.push("repeating_rituals_" + IDArray2[i] + "_RITUAL_RELIGION");
                        f2.push("repeating_rituals_" + IDArray2[i] + "_RITUAL_EML");
                        f2.push("repeating_rituals_" + IDArray2[i] + "_RITUAL_ML");
                    }
                    getAttrs(f2, function(v) {
                    	for (var i=0; i < IDArray2.length; i++) {
                    	    var ml =  parseInt(ritualskills[v["repeating_rituals_" + IDArray2[i] + "_RITUAL_RELIGION"]]);
                    	    var eml = parseInt(v["repeating_rituals_" + IDArray2[i] + "_RITUAL_EML"]) -
                    	        parseInt(v["repeating_rituals_" + IDArray2[i] + "_RITUAL_ML"]) +
                    	        parseInt(ritualskills[v["repeating_rituals_" + IDArray2[i] + "_RITUAL_RELIGION"]]);
                            setAttrs({
                                ["repeating_rituals_" + IDArray2[i] + "_RITUAL_ML"]: ml,
                                ["repeating_rituals_" + IDArray2[i] + "_RITUAL_EML"]: eml

                            });
                    	}
                    });

            	});

            });
        });

    });

</script>

<!-- MOUNTED COMBAT INIT /-->
<script type="text/worker">
    on("change:is_mounted change:encumbrance change:universal_penalty change:steed_init sheet:opened", function() {
       getAttrs([
          "INITIATIVE_ML",
          "UNIVERSAL_PENALTY",
          "ENCUMBRANCE",
          "STEED_INIT",
          "RIDING_ML",
          "COMBAT_INITIATIVE",
          "IS_MOUNTED"
        ], function(values) {
            if(values.IS_MOUNTED != 0) {
                var combatinit= Math.round(((parseInt(values["RIDING_ML"]) + parseInt(values["STEED_INIT"]))/2)  - (parseInt(values["UNIVERSAL_PENALTY"])*5) - (parseInt(values["ENCUMBRANCE"])*5));
            } else {
                var combatinit= parseInt(values["INITIATIVE_ML"]) - (parseInt(values["UNIVERSAL_PENALTY"])*5) - (parseInt(values["ENCUMBRANCE"])*5);
            }
           setAttrs({
                COMBAT_INITIATIVE: combatinit
           });
       });
    });
</script>

<!-- INJURY INFECTED FEEDBACK /-->
<script type="text/worker">
    on("change:repeating_injury:injury_infected", function() {
       getAttrs([
          "repeating_injury_INJURY_INFECTED",
          "repeating_spells_INJURY_INFECTED_FEEDBACK"
        ], function(values) {
            var isInfected = (values.repeating_injury_INJURY_INFECTED == 0 ? 0 : 1);
           setAttrs({
                repeating_injury_INJURY_INFECTED_FEEDBACK: isInfected
           });
       });
    });
</script>


<!-- ENDURANCE /-->
<script type="text/worker">
    on("change:str change:sta change:wil change:condition_ml sheet:opened", function() {
        getAttrs(["STR", "STA", "WIL","CONDITION_ML", "OPTIONAL_RULE_1"], function(values) {
            if(values.OPTIONAL_RULE_1 != 0) {
                var statTotal = parseInt(values["CONDITION_ML"])||0;
                var endurance = Math.round(statTotal / 5)||0;
                setAttrs({
                    "COMBAT_ENDURANCE": endurance
                });
            } else {
                var statTotal = parseInt(values["STR"])||0;
                statTotal += parseInt(values["STA"])||0;
                statTotal += parseInt(values["WIL"])||0;


                var endurance = Math.round(statTotal / 3)||0;
                setAttrs({
                    "COMBAT_ENDURANCE": endurance
                });
            }
        });
    });
</script>

<!-- LOAD AND ENCUMBRANCE /-->
<script type="text/worker">
    on("change:load_weapons_total change:load_armor_total change:load_inventory_total change:combat_endurance change:is_mounted sheet:opened", function() {
        var total = 0.0;
        getAttrs(["LOAD_ARMOR_TOTAL", "LOAD_WEAPONS_TOTAL", "LOAD_INVENTORY_TOTAL", "COMBAT_ENDURANCE", "IS_MOUNTED"], function(values) {
            total += parseFloat(values["LOAD_ARMOR_TOTAL"])||0.0;
            total += parseFloat(values["LOAD_WEAPONS_TOTAL"])||0.0;
            total += parseFloat(values["LOAD_INVENTORY_TOTAL"])||0.0;

            var encumbrance = Math.round(total/values["COMBAT_ENDURANCE"])||0;
            if(values.IS_MOUNTED != 0) { encumbrance = Math.round(encumbrance/2)};
            setAttrs({
                "LOAD_TOTAL": parseInt(total)||0,
                "ENCUMBRANCE": encumbrance
            });
        });
    });
</script>

<!-- UNIVERSAL PENALTY /-->
<script type="text/worker">
    on("change:is_mounted change:injury_total change:fatigue_total sheet:opened", function() {
        getAttrs(["INJURY_TOTAL", "FATIGUE_TOTAL", "UNIVERSAL_PENALTY", "IS_MOUNTED"], function(values) {
            var fatigue = parseInt(values.FATIGUE_TOTAL);
            if(values.IS_MOUNTED == "on") { fatigue = Math.round(fatigue/2)};
            var uPenalty = parseInt(values.INJURY_TOTAL) + fatigue;
            setAttrs({
                "UNIVERSAL_PENALTY": uPenalty
            });
        });
    });
</script>





<!-- ITEM LOAD TOTALS /-->
<script type="text/worker">
    on("change:repeating_inventoryitems:inventory_wgt change:repeating_inventoryitems:inventory_quantity change:repeating_inventoryitems:inventory_worn remove:repeating_inventoryitems  sheet:opened", function() {
	getSectionIDs("repeating_inventoryitems", function(IDArray) {
		var fieldNames = [];
        for (var i=0; i < IDArray.length; i++) {
			fieldNames.push(["repeating_inventoryitems_" + IDArray[i] + "_INVENTORY_WGT",
			"repeating_inventoryitems_" + IDArray[i] + "_INVENTORY_QUANTITY",
			"repeating_inventoryitems_" + IDArray[i] + "_INVENTORY_TYPE",
			"repeating_inventoryitems_" + IDArray[i] + "_INVENTORY_WORN"]
			);
		}


        var atotal = 0.0;
        var wtotal = 0.0;
        var itotal = 0.0;
        var x = 0;
        for (var i=0; i < IDArray.length; i++) {
            getAttrs(fieldNames[i], function(values) {
                if ((values["repeating_inventoryitems_" + IDArray[x] + "_INVENTORY_TYPE"] == "Armor") &&  (values["repeating_inventoryitems_" + IDArray[x] + "_INVENTORY_WORN"] == "on")) {
                    atotal += ((parseFloat(values["repeating_inventoryitems_" + IDArray[x] + "_INVENTORY_WGT"])||0.0) * (parseFloat(values["repeating_inventoryitems_" + IDArray[x] + "_INVENTORY_QUANTITY"])||1.0));
                } else if ((values["repeating_inventoryitems_" + IDArray[x] + "_INVENTORY_TYPE"] == "Weapon") &&  (values["repeating_inventoryitems_" + IDArray[x] + "_INVENTORY_WORN"] == "on")) {
                    wtotal += ((parseFloat(values["repeating_inventoryitems_" + IDArray[x] + "_INVENTORY_WGT"])||0.0) * (parseFloat(values["repeating_inventoryitems_" + IDArray[x] + "_INVENTORY_QUANTITY"])||1.0));
                } else if (values["repeating_inventoryitems_" + IDArray[x] + "_INVENTORY_WORN"] == "on") {
                    itotal += ((parseFloat(values["repeating_inventoryitems_" + IDArray[x] + "_INVENTORY_WGT"])||0.0) * (parseFloat(values["repeating_inventoryitems_" + IDArray[x] + "_INVENTORY_QUANTITY"])||1.0));
                }
    			x++;


    			itotal.toFixed(2);
    			setAttrs({
    				"LOAD_INVENTORY_TOTAL": itotal
    			});
    			atotal.toFixed(2);
    			setAttrs({
    				"LOAD_ARMOR_TOTAL": atotal
    			});
    			wtotal.toFixed(2);
    			setAttrs({
    				"LOAD_WEAPONS_TOTAL": wtotal
    			});
            });

        }
	});
});

</script>

<script type="text/worker">
    const buttonlist = ["character","skills","combat","inventory","armor","supernatural","notes"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function() {
            setAttrs({
                sheetTab: button
            });
        });
    });
</script>


